{"version":3,"sources":["instafeed/instafeed.js"],"names":["Instafeed","root","factory","params","context","option","value","this","options","target","get","resolution","sortBy","links","mock","useHttp","unique","_genKey","prototype","hasNext","nextUrl","length","next","run","url","instanceName","script","clientId","accessToken","Error","before","call","document","createElement","id","src","_buildUrl","getElementsByTagName","appendChild","window","parse","response","anchor","childNodeCount","childNodeIndex","childNodesArr","eMsg","fragment","htmlString","i","image","imageObj","imageUrl","images","img","imgHeight","imgOrient","imgWidth","j","k","len","len1","len2","node","parsedLimit","reverse","sortSettings","targetEl","tmpEl","error","meta","code","error_message","data","success","pagination","next_url","split","sort","Math","random","_sortBy","parseInt","limit","slice","createDocumentFragment","filter","_filter","template","width","height","location","protocol","indexOf","replace","_makeTemplate","model","link","type","orientation","caption","_getObjectProperty","likes","count","comments","innerHTML","childNodes","push","href","getElementById","removeChild","_error","after","endpoint","final","tagName","locationId","userId","base","S4","toString","substring","output","pattern","ref","varName","varValue","test","match","object","property","piece","pieces","shift","sorter","a","b","valueA","valueB","bind","filteredImages","fn","define","amd","module","exports"],"mappings":"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","file":"instafeed.min.js","sourcesContent":["// Generated by CoffeeScript 1.9.3\n(function() {\n  var Instafeed;\n\n  Instafeed = (function() {\n    function Instafeed(params, context) {\n      var option, value;\n      this.options = {\n        target: 'instafeed',\n        get: 'popular',\n        resolution: 'thumbnail',\n        sortBy: 'none',\n        links: true,\n        mock: false,\n        useHttp: false\n      };\n      if (typeof params === 'object') {\n        for (option in params) {\n          value = params[option];\n          this.options[option] = value;\n        }\n      }\n      this.context = context != null ? context : this;\n      this.unique = this._genKey();\n    }\n\n    Instafeed.prototype.hasNext = function() {\n      return typeof this.context.nextUrl === 'string' && this.context.nextUrl.length > 0;\n    };\n\n    Instafeed.prototype.next = function() {\n      if (!this.hasNext()) {\n        return false;\n      }\n      return this.run(this.context.nextUrl);\n    };\n\n    Instafeed.prototype.run = function(url) {\n      var header, instanceName, script;\n      if (typeof this.options.clientId !== 'string') {\n        if (typeof this.options.accessToken !== 'string') {\n          throw new Error(\"Missing clientId or accessToken.\");\n        }\n      }\n      if (typeof this.options.accessToken !== 'string') {\n        if (typeof this.options.clientId !== 'string') {\n          throw new Error(\"Missing clientId or accessToken.\");\n        }\n      }\n      if ((this.options.before != null) && typeof this.options.before === 'function') {\n        this.options.before.call(this);\n      }\n      if (typeof document !== \"undefined\" && document !== null) {\n        script = document.createElement('script');\n        script.id = 'instafeed-fetcher';\n        script.src = url || this._buildUrl();\n        header = document.getElementsByTagName('head');\n        header[0].appendChild(script);\n        instanceName = \"instafeedCache\" + this.unique;\n        window[instanceName] = new Instafeed(this.options, this);\n        window[instanceName].unique = this.unique;\n      }\n      return true;\n    };\n\n    Instafeed.prototype.parse = function(response) {\n      var anchor, childNodeCount, childNodeIndex, childNodesArr, e, eMsg, fragment, header, htmlString, httpProtocol, i, image, imageObj, imageString, imageUrl, images, img, imgHeight, imgOrient, imgUrl, imgWidth, instanceName, j, k, len, len1, len2, node, parsedLimit, reverse, sortSettings, targetEl, tmpEl;\n      if (typeof response !== 'object') {\n        if ((this.options.error != null) && typeof this.options.error === 'function') {\n          this.options.error.call(this, 'Invalid JSON data');\n          return false;\n        } else {\n          throw new Error('Invalid JSON response');\n        }\n      }\n      if (response.meta.code !== 200) {\n        if ((this.options.error != null) && typeof this.options.error === 'function') {\n          this.options.error.call(this, response.meta.error_message);\n          return false;\n        } else {\n          throw new Error(\"Error from Instagram: \" + response.meta.error_message);\n        }\n      }\n      if (response.data.length === 0) {\n        if ((this.options.error != null) && typeof this.options.error === 'function') {\n          this.options.error.call(this, 'No images were returned from Instagram');\n          return false;\n        } else {\n          throw new Error('No images were returned from Instagram');\n        }\n      }\n      if ((this.options.success != null) && typeof this.options.success === 'function') {\n        this.options.success.call(this, response);\n      }\n      this.context.nextUrl = '';\n      if (response.pagination != null) {\n        this.context.nextUrl = response.pagination.next_url;\n      }\n      if (this.options.sortBy !== 'none') {\n        if (this.options.sortBy === 'random') {\n          sortSettings = ['', 'random'];\n        } else {\n          sortSettings = this.options.sortBy.split('-');\n        }\n        reverse = sortSettings[0] === 'least' ? true : false;\n        switch (sortSettings[1]) {\n          case 'random':\n            response.data.sort(function() {\n              return 0.5 - Math.random();\n            });\n            break;\n          case 'recent':\n            response.data = this._sortBy(response.data, 'created_time', reverse);\n            break;\n          case 'liked':\n            response.data = this._sortBy(response.data, 'likes.count', reverse);\n            break;\n          case 'commented':\n            response.data = this._sortBy(response.data, 'comments.count', reverse);\n            break;\n          default:\n            throw new Error(\"Invalid option for sortBy: '\" + this.options.sortBy + \"'.\");\n        }\n      }\n      if ((typeof document !== \"undefined\" && document !== null) && this.options.mock === false) {\n        images = response.data;\n        parsedLimit = parseInt(this.options.limit, 10);\n        if ((this.options.limit != null) && images.length > parsedLimit) {\n          images = images.slice(0, parsedLimit);\n        }\n        fragment = document.createDocumentFragment();\n        if ((this.options.filter != null) && typeof this.options.filter === 'function') {\n          images = this._filter(images, this.options.filter);\n        }\n        if ((this.options.template != null) && typeof this.options.template === 'string') {\n          htmlString = '';\n          imageString = '';\n          imgUrl = '';\n          tmpEl = document.createElement('div');\n          for (i = 0, len = images.length; i < len; i++) {\n            image = images[i];\n            imageObj = image.images[this.options.resolution];\n            if (typeof imageObj !== 'object') {\n              eMsg = \"No image found for resolution: \" + this.options.resolution + \".\";\n              throw new Error(eMsg);\n            }\n            imgWidth = imageObj.width;\n            imgHeight = imageObj.height;\n            imgOrient = \"square\";\n            if (imgWidth > imgHeight) {\n              imgOrient = \"landscape\";\n            }\n            if (imgWidth < imgHeight) {\n              imgOrient = \"portrait\";\n            }\n            imageUrl = imageObj.url;\n            httpProtocol = window.location.protocol.indexOf(\"http\") >= 0;\n            if (httpProtocol && !this.options.useHttp) {\n              imageUrl = imageUrl.replace(/https?:\\/\\//, '//');\n            }\n            imageString = this._makeTemplate(this.options.template, {\n              model: image,\n              id: image.id,\n              link: image.link,\n              type: image.type,\n              image: imageUrl,\n              width: imgWidth,\n              height: imgHeight,\n              orientation: imgOrient,\n              caption: this._getObjectProperty(image, 'caption.text'),\n              likes: image.likes.count,\n              comments: image.comments.count,\n              location: this._getObjectProperty(image, 'location.name')\n            });\n            htmlString += imageString;\n          }\n          tmpEl.innerHTML = htmlString;\n          childNodesArr = [];\n          childNodeIndex = 0;\n          childNodeCount = tmpEl.childNodes.length;\n          while (childNodeIndex < childNodeCount) {\n            childNodesArr.push(tmpEl.childNodes[childNodeIndex]);\n            childNodeIndex += 1;\n          }\n          for (j = 0, len1 = childNodesArr.length; j < len1; j++) {\n            node = childNodesArr[j];\n            fragment.appendChild(node);\n          }\n        } else {\n          for (k = 0, len2 = images.length; k < len2; k++) {\n            image = images[k];\n            img = document.createElement('img');\n            imageObj = image.images[this.options.resolution];\n            if (typeof imageObj !== 'object') {\n              eMsg = \"No image found for resolution: \" + this.options.resolution + \".\";\n              throw new Error(eMsg);\n            }\n            imageUrl = imageObj.url;\n            httpProtocol = window.location.protocol.indexOf(\"http\") >= 0;\n            if (httpProtocol && !this.options.useHttp) {\n              imageUrl = imageUrl.replace(/https?:\\/\\//, '//');\n            }\n            img.src = imageUrl;\n            if (this.options.links === true) {\n              anchor = document.createElement('a');\n              anchor.href = image.link;\n              anchor.appendChild(img);\n              fragment.appendChild(anchor);\n            } else {\n              fragment.appendChild(img);\n            }\n          }\n        }\n        targetEl = this.options.target;\n        if (typeof targetEl === 'string') {\n          targetEl = document.getElementById(targetEl);\n        }\n        if (targetEl == null) {\n          eMsg = \"No element with id=\\\"\" + this.options.target + \"\\\" on page.\";\n          throw new Error(eMsg);\n        }\n        targetEl.appendChild(fragment);\n        header = document.getElementsByTagName('head')[0];\n        header.removeChild(document.getElementById('instafeed-fetcher'));\n        instanceName = \"instafeedCache\" + this.unique;\n        window[instanceName] = void 0;\n        try {\n          delete window[instanceName];\n        } catch (_error) {\n          e = _error;\n        }\n      }\n      if ((this.options.after != null) && typeof this.options.after === 'function') {\n        this.options.after.call(this);\n      }\n      return true;\n    };\n\n    Instafeed.prototype._buildUrl = function() {\n      var base, endpoint, final;\n      base = \"https://api.instagram.com/v1\";\n      switch (this.options.get) {\n        case \"popular\":\n          endpoint = \"media/popular\";\n          break;\n        case \"tagged\":\n          if (!this.options.tagName) {\n            throw new Error(\"No tag name specified. Use the 'tagName' option.\");\n          }\n          endpoint = \"tags/\" + this.options.tagName + \"/media/recent\";\n          break;\n        case \"location\":\n          if (!this.options.locationId) {\n            throw new Error(\"No location specified. Use the 'locationId' option.\");\n          }\n          endpoint = \"locations/\" + this.options.locationId + \"/media/recent\";\n          break;\n        case \"user\":\n          if (!this.options.userId) {\n            throw new Error(\"No user specified. Use the 'userId' option.\");\n          }\n          endpoint = \"users/\" + this.options.userId + \"/media/recent\";\n          break;\n        default:\n          throw new Error(\"Invalid option for get: '\" + this.options.get + \"'.\");\n      }\n      final = base + \"/\" + endpoint;\n      if (this.options.accessToken != null) {\n        final += \"?access_token=\" + this.options.accessToken;\n      } else {\n        final += \"?client_id=\" + this.options.clientId;\n      }\n      if (this.options.limit != null) {\n        final += \"&count=\" + this.options.limit;\n      }\n      final += \"&callback=instafeedCache\" + this.unique + \".parse\";\n      return final;\n    };\n\n    Instafeed.prototype._genKey = function() {\n      var S4;\n      S4 = function() {\n        return (((1 + Math.random()) * 0x10000) | 0).toString(16).substring(1);\n      };\n      return \"\" + (S4()) + (S4()) + (S4()) + (S4());\n    };\n\n    Instafeed.prototype._makeTemplate = function(template, data) {\n      var output, pattern, ref, varName, varValue;\n      pattern = /(?:\\{{2})([\\w\\[\\]\\.]+)(?:\\}{2})/;\n      output = template;\n      while (pattern.test(output)) {\n        varName = output.match(pattern)[1];\n        varValue = (ref = this._getObjectProperty(data, varName)) != null ? ref : '';\n        output = output.replace(pattern, function() {\n          return \"\" + varValue;\n        });\n      }\n      return output;\n    };\n\n    Instafeed.prototype._getObjectProperty = function(object, property) {\n      var piece, pieces;\n      property = property.replace(/\\[(\\w+)\\]/g, '.$1');\n      pieces = property.split('.');\n      while (pieces.length) {\n        piece = pieces.shift();\n        if ((object != null) && piece in object) {\n          object = object[piece];\n        } else {\n          return null;\n        }\n      }\n      return object;\n    };\n\n    Instafeed.prototype._sortBy = function(data, property, reverse) {\n      var sorter;\n      sorter = function(a, b) {\n        var valueA, valueB;\n        valueA = this._getObjectProperty(a, property);\n        valueB = this._getObjectProperty(b, property);\n        if (reverse) {\n          if (valueA > valueB) {\n            return 1;\n          } else {\n            return -1;\n          }\n        }\n        if (valueA < valueB) {\n          return 1;\n        } else {\n          return -1;\n        }\n      };\n      data.sort(sorter.bind(this));\n      return data;\n    };\n\n    Instafeed.prototype._filter = function(images, filter) {\n      var filteredImages, fn, i, image, len;\n      filteredImages = [];\n      fn = function(image) {\n        if (filter(image)) {\n          return filteredImages.push(image);\n        }\n      };\n      for (i = 0, len = images.length; i < len; i++) {\n        image = images[i];\n        fn(image);\n      }\n      return filteredImages;\n    };\n\n    return Instafeed;\n\n  })();\n\n  (function(root, factory) {\n    if (typeof define === 'function' && define.amd) {\n      return define([], factory);\n    } else if (typeof module === 'object' && module.exports) {\n      return module.exports = factory();\n    } else {\n      return root.Instafeed = factory();\n    }\n  })(this, function() {\n    return Instafeed;\n  });\n\n}).call(this);\n"]}